# 微信公众号开发

公众号接入自己的服务器，需要下载官方文件来调用接口

[开始开发 / 接入指南](https://developers.weixin.qq.com/doc/offiaccount/Basic_Information/Access_Overview.html)

```
AppID wx5da5cf76e3128cfa
AppSecret   ff1a722268dae84b939cd0f5e5f0e8e8
Token hanphone17285
EncodingAESKEY D5JmwtuymddHdqeiORtdFoSpkZUdBI4OaUH7mIb3jI3
```

php代码示例已给，用php





不使用服务器，可使用微信提供的功能


## 微信登录接口

在开发一款微信小程序时，需要用户进行微信登录，获取用户的手机号码来作为用户的唯一标识（userId），于是探索获取用户手机号码的方式；

（当然，通过wx.login来获取code，进而换取用户的openid也是可以的）

目前版本的微信小程序获取用户手机号码的方式如下：

前端开发参考：[developers.weixin.qq.com/miniprogram…](https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fframework%2Fopen-ability%2FgetPhoneNumber.html "https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html")
后端开发参考：

[developers.weixin.qq.com/miniprogram…](https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2FOpenApiDoc%2Fuser-info%2Fphone-number%2FgetPhoneNumber.html "https://developers.weixin.qq.com/miniprogram/dev/OpenApiDoc/user-info/phone-number/getPhoneNumber.html")

步骤如下：

①利用手机号快速填写的功能，将button组件 `open-type` 的值设置为 `getPhoneNumber`

②用户点击按钮，弹出申请获取用户手机号的弹窗：

  ③如果用户点击允许，则可以通过`bindgetphonenumber`事件回调获取到动态令牌code（注意这里的code和wx.login的code不一样，而且获取用户手机号码不需要提前调用wx.login获取code了）

④把code传到开发者后台，并在开发者后台调用微信后台提供的 `phonenumber.getPhoneNumber` 接口，消费code来换取用户手机号

**注意一点，获取手机号的功能好像只允许经过认证的小程序使用，如果未认证只能使用测试号才可以！恶心死了！**


## 微信支付接口




### 配置服务器域名与业务域名

必须先通过认证才能配置业务域名。（其实本质上就是跳转不了第三方H5，只允许你跳转第三方小程序）

手机可以打开体验版的小程序的调试模式，避免校验



### 获取公众号页面路径

https://kf.qq.com/faq/180725biaAn2180725VnQjYF.html